---
title: "Patrick's Auto Shop Productivity Report"
subtitle: "Where Should You Spend Your Time?"
author: "Abbonizio Business Analytics Consulting LLC"
date: today
format:
  html:
    theme: flatly
    toc: true
    toc-depth: 2
    code-fold: true
    code-summary: "Show code"
execute:
  echo: false
  warning: false
  message: false
---

```{python}
#| include: false
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# Set style
plt.style.use('seaborn-v0_8-whitegrid')
sns.set_palette("husl")

# Load data
carsDF = pd.read_csv("carsFixed.csv")

# Create descriptive labels
carsDF['Shop'] = 'Shop ' + carsDF['shopID'].astype(str)
carsDF['Boss Present'] = carsDF['boss'].map({0: 'You Away', 1: 'You Present'})

# Calculate summary stats
summary = carsDF.groupby(['shopID', 'boss'])['carsFixed'].agg(['mean', 'std', 'count']).reset_index()
summary_pivot = summary.pivot(index='shopID', columns='boss', values='mean')
summary_pivot.columns = ['Boss Away', 'Boss Present']
summary_pivot['Boost'] = summary_pivot['Boss Present'] - summary_pivot['Boss Away']

# Calculate confidence intervals (95%)
def calc_ci(group):
    n = len(group)
    mean = group.mean()
    std = group.std()
    se = std / np.sqrt(n)
    ci = 1.96 * se
    return pd.Series({'mean': mean, 'ci': ci, 'n': n})

boss_stats = carsDF.groupby(['shopID', 'boss'])['carsFixed'].apply(calc_ci).unstack()
```

## The Bottom Line ðŸŽ¯

**Patrick, here's what your data tells us:** Your presence at the shop matters most at **Shop 4** and **Shop 1**. When you're there, these shops fix significantly more cars. Some other shops? They do just fine without you.

**Our recommendation:** Focus your time on **Shop 4** and **Shop 1**. Your brother's shop (Shop 3) shows the least benefit from your presence. Shop 2 shows promise but needs more data to confirm.

---

## What the Data Shows

We analyzed 250 days of productivity data across your 5 shops. Here's every single day plottedâ€”you can see the pattern clearly:

```{python}
#| fig-cap: "Each dot is one day. Green = you were there. Orange = you were away. Delta shows the difference in average cars fixed."
#| fig-width: 9.5
#| fig-height: 10

fig, ax = plt.subplots(figsize=(11, 10))

np.random.seed(42)
jitter = 0.15

colors = {'You Away': '#E67E22', 'You Present': '#27AE60'}
shop_colors = ['#E74C3C', '#3498DB', '#2ECC71', '#9B59B6', '#F39C12']

# Stack all shops in one column
for i, shop in enumerate(range(1, 6)):
    shop_data = carsDF[carsDF['shopID'] == shop]
    
    # Plot points for each boss presence status, stacked vertically by shop
    for j, (boss_label, color) in enumerate(colors.items()):
        mask = shop_data['Boss Present'] == boss_label
        data = shop_data[mask]
        x = np.zeros(len(data)) + i + np.random.uniform(-jitter, jitter, len(data))
        ax.scatter(x, data['carsFixed'], alpha=0.6, s=50, c=color, 
                   edgecolors='white', linewidth=0.5)
    
    # Calculate and show means
    away_mean = shop_data[shop_data['boss'] == 0]['carsFixed'].mean()
    present_mean = shop_data[shop_data['boss'] == 1]['carsFixed'].mean()
    delta = present_mean - away_mean
    
    # Draw mean lines
    ax.hlines(away_mean, i - 0.3, i + 0.3, colors='#E67E22', linewidth=3, linestyle='-')
    ax.hlines(present_mean, i - 0.3, i + 0.3, colors='#27AE60', linewidth=3, linestyle='-')
    
    # Add delta label above the data
    delta_color = '#27AE60' if delta > 0 else '#E74C3C'
    delta_label = f'+{delta:.1f}' if delta > 0 else f'{delta:.1f}'
    ax.text(i, 72, f'Î” {delta_label}', ha='center', va='center', fontsize=10, 
            fontweight='bold', color='white',
            bbox=dict(boxstyle='round,pad=0.3', facecolor=delta_color, edgecolor='none', alpha=0.9))
    
    # Get sample sizes
    n_away = len(shop_data[shop_data['boss'] == 0])
    n_present = len(shop_data[shop_data['boss'] == 1])
    ax.text(i, -5, f'n={n_away+n_present}', ha='center', fontsize=9, style='italic')

# Set up axes
ax.set_xticks(range(5))
ax.set_xticklabels([f'Shop {i}' for i in range(1, 6)], fontsize=11, fontweight='bold')
ax.set_ylabel('Cars Fixed (Daily Productivity)', fontweight='bold', fontsize=12)
ax.set_ylim(-10, 90)
ax.set_xlim(-0.6, 4.6)

# Add legend
from matplotlib.patches import Patch
legend_elements = [Patch(facecolor='#E67E22', label='You Away'),
                   Patch(facecolor='#27AE60', label='You Present')]
ax.legend(handles=legend_elements, loc='upper right', fontsize=11, title='Your Presence', 
          title_fontsize=12, frameon=True)

ax.set_title('Daily Productivity by Shop: All Data Stacked', fontsize=14, fontweight='bold')
plt.tight_layout()
plt.show()
```

**What you see:** All shops are stacked in one view, with each column showing one shop's daily productivity. Green dots = you were there, orange dots = you were away. The horizontal lines show the mean for each condition. The delta (Î”) shows how many more cars get fixed when you're there. Shop 4 has the biggest delta (+12.6), while Shop 3 (your brother's shop) shows the smallest improvement (+3.4).

---

## Distribution Comparison: Violin Plot

This violin plot reveals the full shape of productivity distributionsâ€”not just averages, but how spread out and consistent each shop performs:

```{python}
#| fig-cap: "Violin plot showing productivity distributions by shop and boss presence"
#| fig-width: 8
#| fig-height: 6

fig, ax = plt.subplots(figsize=(8, 6))

# Prepare data for violin plot
shop_ids = sorted(carsDF['shopID'].unique())
positions_away = np.arange(len(shop_ids)) * 2.5
positions_present = positions_away + 0.8

# Custom colors
color_away = '#E67E22'
color_present = '#27AE60'

# Create violin data lists
data_away = [carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == 0)]['carsFixed'].values for shop in shop_ids]
data_present = [carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == 1)]['carsFixed'].values for shop in shop_ids]

# Plot violins for "Boss Away"
vp_away = ax.violinplot(data_away, positions=positions_away, widths=0.7, showmeans=True, showmedians=False)
for body in vp_away['bodies']:
    body.set_facecolor(color_away)
    body.set_edgecolor('black')
    body.set_alpha(0.7)
vp_away['cmeans'].set_color('black')
vp_away['cmins'].set_color(color_away)
vp_away['cmaxes'].set_color(color_away)
vp_away['cbars'].set_color(color_away)

# Plot violins for "Boss Present"
vp_present = ax.violinplot(data_present, positions=positions_present, widths=0.7, showmeans=True, showmedians=False)
for body in vp_present['bodies']:
    body.set_facecolor(color_present)
    body.set_edgecolor('black')
    body.set_alpha(0.7)
vp_present['cmeans'].set_color('black')
vp_present['cmins'].set_color(color_present)
vp_present['cmaxes'].set_color(color_present)
vp_present['cbars'].set_color(color_present)

# Add mean labels
for i, shop in enumerate(shop_ids):
    away_mean = carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == 0)]['carsFixed'].mean()
    present_mean = carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == 1)]['carsFixed'].mean()
    ax.text(positions_away[i], away_mean + 4, f'{away_mean:.1f}', ha='center', fontsize=9, fontweight='bold', color=color_away)
    ax.text(positions_present[i], present_mean + 4, f'{present_mean:.1f}', ha='center', fontsize=9, fontweight='bold', color=color_present)

# Labels and styling
ax.set_xticks(positions_away + 0.4)
ax.set_xticklabels([f'Shop {s}' for s in shop_ids], fontsize=11, fontweight='bold')
ax.set_ylabel('Cars Fixed', fontsize=12, fontweight='bold')
ax.set_xlabel('')
ax.set_title('Productivity Distributions: Shape Matters as Much as Averages', fontsize=14, fontweight='bold')
ax.set_ylim(0, 80)

# Legend
from matplotlib.patches import Patch
legend_elements = [Patch(facecolor=color_away, edgecolor='black', alpha=0.7, label='Boss Away'),
                   Patch(facecolor=color_present, edgecolor='black', alpha=0.7, label='Boss Present')]
ax.legend(handles=legend_elements, loc='upper right', fontsize=10)

ax.grid(axis='y', alpha=0.3, linestyle='--')
plt.tight_layout()
plt.show()
```

**Reading this chart:** The "width" of each violin shows how common different productivity levels are. Notice how Shop 4's "Boss Present" violin is not only higher but also narrower at the bottomâ€”when you're there, productivity is consistently high. Shop 3 shows the most overlap between orange and green, confirming your presence makes less difference there.

---

## Split Violin Plot: Direct Comparison by Shop

This split violin plot shows the productivity distribution for each shop with boss presence on opposite sidesâ€”making it easy to compare the "shape" of performance directly:

```{python}
#| fig-cap: "Split violin plot: Each shop's productivity distribution split by boss presence (orange = away, green = present)"
#| fig-width: 8
#| fig-height: 8

fig, ax = plt.subplots(figsize=(8, 8))

# Create split violin plot using seaborn
sns.violinplot(data=carsDF, x='Shop', y='carsFixed', hue='Boss Present',
               split=True, inner='quart', palette={'You Away': '#E67E22', 'You Present': '#27AE60'},
               ax=ax, linewidth=1)

# Add mean markers for each group
shop_ids = sorted(carsDF['shopID'].unique())
for i, shop in enumerate(shop_ids):
    away_mean = carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == 0)]['carsFixed'].mean()
    present_mean = carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == 1)]['carsFixed'].mean()
    delta = present_mean - away_mean
    
    # Plot mean markers
    ax.scatter(i - 0.1, away_mean, color='#E67E22', s=80, marker='D', edgecolor='black', linewidth=1.5, zorder=5)
    ax.scatter(i + 0.1, present_mean, color='#27AE60', s=80, marker='D', edgecolor='black', linewidth=1.5, zorder=5)
    
    # Add delta annotation above each shop
    delta_color = '#27AE60' if delta > 0 else '#E74C3C'
    delta_label = f'+{delta:.1f}' if delta > 0 else f'{delta:.1f}'
    ax.text(i, 72, f'Î” {delta_label}', ha='center', fontsize=10, fontweight='bold', color=delta_color,
            bbox=dict(boxstyle='round,pad=0.3', facecolor='white', edgecolor=delta_color, alpha=0.9))

# Styling
ax.set_xlabel('', fontsize=12)
ax.set_ylabel('Cars Fixed', fontsize=12, fontweight='bold')
ax.set_title('Split Violin: Productivity Distributions by Shop and Boss Presence', fontsize=14, fontweight='bold')
ax.set_ylim(0, 90)
ax.legend(title='Boss Presence', loc='upper left', fontsize=10, title_fontsize=11)
ax.grid(axis='y', alpha=0.3, linestyle='--')

# Add annotation explaining diamond markers
ax.text(0.98, 0.02, 'â—† = Mean', transform=ax.transAxes, fontsize=9, ha='right', va='bottom',
        bbox=dict(boxstyle='round', facecolor='white', edgecolor='gray', alpha=0.8))

plt.tight_layout()
plt.show()
```

**What this shows:** The split violin gives you a direct side-by-side comparison within each shop. The left side (orange) shows the distribution when you're away; the right side (green) shows when you're present. The diamonds mark the mean values. Notice how Shop 4's green side extends much higher than its orange sideâ€”and the delta (+12.6) confirms this is where your presence has the most impact.

---

## 3D View: Shop Performance Landscape

Here's an interactive 3D perspective showing all three dimensions at onceâ€”Shop ID, your presence status, and cars fixed:

```{python}
#| fig-cap: "3D visualization: Shop ID Ã— Boss Presence Ã— Cars Fixed"
#| fig-width: 10
#| fig-height: 8

from mpl_toolkits.mplot3d import Axes3D

fig = plt.figure(figsize=(10, 8))
ax = fig.add_subplot(111, projection='3d')

# Add jitter for better visibility
np.random.seed(42)
jitter_x = 0.1
jitter_y = 0.05

# Create colors based on boss presence
colors_3d = ['#E67E22' if b == 0 else '#27AE60' for b in carsDF['boss']]

# Add jittered positions (flip boss so Present is at y=0, Away is at y=1)
x_jittered = carsDF['shopID'] + np.random.uniform(-jitter_x, jitter_x, len(carsDF))
y_jittered = (1 - carsDF['boss']) + np.random.uniform(-jitter_y, jitter_y, len(carsDF))

# Create the 3D scatter plot
scatter = ax.scatter(x_jittered, y_jittered, carsDF['carsFixed'], 
                     c=colors_3d, s=60, alpha=0.7, edgecolors='white', linewidth=0.5)

# Set labels
ax.set_xlabel('\nShop ID', fontsize=11, fontweight='bold')
ax.set_ylabel('\nBoss Presence', fontsize=11, fontweight='bold')
ax.set_zlabel('\nCars Fixed', fontsize=11, fontweight='bold')
ax.set_title('3D View: Productivity by Shop and Boss Presence', fontsize=14, fontweight='bold', pad=20)

# Set tick labels
ax.set_xticks([1, 2, 3, 4, 5])
ax.set_xticklabels(['Shop 1', 'Shop 2', 'Shop 3', 'Shop 4', 'Shop 5'])
ax.set_yticks([0, 1])
ax.set_yticklabels(['Present', 'Away'])

# Add mean surfaces/bars for each shop-boss combination (flip y so Present is at 0, Away at 1)
for shop in range(1, 6):
    for boss in [0, 1]:
        mean_cars = carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == boss)]['carsFixed'].mean()
        color = '#E67E22' if boss == 0 else '#27AE60'
        y_pos = 1 - boss  # Flip: boss=1 (Present) goes to y=0, boss=0 (Away) goes to y=1
        ax.bar3d(shop - 0.2, y_pos - 0.1, 0, 0.4, 0.2, mean_cars, 
                 color=color, alpha=0.3, edgecolor='black', linewidth=0.5)

# Create custom legend
from matplotlib.lines import Line2D
legend_elements = [Line2D([0], [0], marker='o', color='w', markerfacecolor='#E67E22', 
                          markersize=10, label='Boss Away'),
                   Line2D([0], [0], marker='o', color='w', markerfacecolor='#27AE60', 
                          markersize=10, label='Boss Present')]
ax.legend(handles=legend_elements, loc='upper left', fontsize=10)

# Adjust view angle for better visualization
ax.view_init(elev=20, azim=45)

plt.tight_layout()
plt.show()
```

**Reading this 3D chart:** The vertical bars show the average cars fixed for each shop-boss combination, while the scattered dots are individual daily observations. Notice how Shop 1 and Shop 4 show the biggest vertical gaps between the orange (away) and green (present) barsâ€”that's your impact visualized in 3D space.

---

## The "Boss Boost" Effect

Here's the real question: **How many extra cars get fixed when you're at each shop?**

```{python}
#| fig-cap: "The 'Boss Boost'â€”extra cars fixed when you're present vs. away"
#| fig-width: 7
#| fig-height: 5

# Calculate boost with confidence intervals
boosts = []
for shop in range(1, 6):
    present = carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == 1)]['carsFixed']
    away = carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == 0)]['carsFixed']
    
    boost = present.mean() - away.mean()
    # Bootstrap-like SE estimate
    se_present = present.std() / np.sqrt(len(present))
    se_away = away.std() / np.sqrt(len(away))
    se_diff = np.sqrt(se_present**2 + se_away**2)
    ci = 1.96 * se_diff
    
    boosts.append({'Shop': f'Shop {shop}', 'Boost': boost, 'CI': ci})

boost_df = pd.DataFrame(boosts)

fig, ax = plt.subplots(figsize=(7, 5))

# Color bars by positive/negative boost
colors_bars = ['#27AE60' if b > 2 else '#E67E22' if b < 0 else '#95A5A6' for b in boost_df['Boost']]

bars = ax.bar(boost_df['Shop'], boost_df['Boost'], color=colors_bars, edgecolor='black', linewidth=1.2)
ax.errorbar(boost_df['Shop'], boost_df['Boost'], yerr=boost_df['CI'], fmt='none', 
            color='black', capsize=5, capthick=2, linewidth=2)

ax.axhline(y=0, color='black', linestyle='-', linewidth=1)
ax.set_ylabel('Extra Cars Fixed Per Day\n(When You\'re Present)', fontsize=11, fontweight='bold')
ax.set_xlabel('', fontsize=11)
ax.set_title('Your Impact: The "Boss Boost" at Each Shop', fontsize=14, fontweight='bold')

# Add value labels below the bars
for bar, boost, ci in zip(bars, boost_df['Boost'], boost_df['CI']):
    height = bar.get_height()
    label = f'+{height:.1f}' if height > 0 else f'{height:.1f}'
    ax.annotate(label, xy=(bar.get_x() + bar.get_width()/2, 0),
                xytext=(0, -8), textcoords='offset points',
                ha='center', va='top', fontsize=12, fontweight='bold')

ax.set_ylim(-5, 25)
plt.tight_layout()
plt.show()
```

**Key Findings:**

| Shop | Extra Cars/Day | What This Means |
|------|----------------|-----------------|
| **Shop 4** | **+12.6** | ðŸŒŸ **Biggest impact!** Your presence makes a huge difference |
| **Shop 2** | **+10.1** | ðŸŒŸ **Big impact!** But only 5 days of dataâ€”needs more tracking |
| Shop 5 | +8.8 | Strong boost, this shop responds well to your presence |
| Shop 1 | +7.0 | Solid impactâ€”definitely worth your time |
| Shop 3 | +3.4 | Small boostâ€”your brother's shop does okay either way |

---

## How Confident Can You Be?

**The honest truth:** We only have 250 days of data, and you weren't at every shop equally. Here's what that means:

```{python}
#| fig-cap: "Sample sizes and reliability of our estimates"
#| fig-width: 6
#| fig-height: 6

# Sample size breakdown
sample_sizes = carsDF.groupby(['Shop', 'Boss Present']).size().unstack()

fig, axes = plt.subplots(2, 1, figsize=(6, 6))

# Top plot: Sample sizes
ax1 = axes[0]
x = np.arange(5)
width = 0.35

away_counts = carsDF[carsDF['boss'] == 0].groupby('shopID').size().values
present_counts = carsDF[carsDF['boss'] == 1].groupby('shopID').size().values

bars1 = ax1.bar(x - width/2, away_counts, width, label='You Away', color='#E67E22', edgecolor='black')
bars2 = ax1.bar(x + width/2, present_counts, width, label='You Present', color='#27AE60', edgecolor='black')

ax1.set_ylabel('Number of Days', fontweight='bold')
ax1.set_xlabel('')
ax1.set_title('How Many Days of Data?', fontweight='bold')
ax1.set_xticks(x)
ax1.set_xticklabels(['Shop 1', 'Shop 2', 'Shop 3', 'Shop 4', 'Shop 5'])
ax1.legend()

# Add count labels
for bar in bars1:
    ax1.annotate(f'{int(bar.get_height())}', xy=(bar.get_x() + bar.get_width()/2, bar.get_height()),
                 xytext=(0, 3), textcoords='offset points', ha='center', fontsize=9)
for bar in bars2:
    ax1.annotate(f'{int(bar.get_height())}', xy=(bar.get_x() + bar.get_width()/2, bar.get_height()),
                 xytext=(0, 3), textcoords='offset points', ha='center', fontsize=9)

# Bottom plot: Confidence ranges
ax2 = axes[1]
for i, shop in enumerate(range(1, 6)):
    present = carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == 1)]['carsFixed']
    away = carsDF[(carsDF['shopID'] == shop) & (carsDF['boss'] == 0)]['carsFixed']
    
    boost = present.mean() - away.mean()
    se_present = present.std() / np.sqrt(len(present))
    se_away = away.std() / np.sqrt(len(away))
    se_diff = np.sqrt(se_present**2 + se_away**2)
    ci = 1.96 * se_diff
    
    color = '#27AE60' if boost - ci > 0 else '#95A5A6'
    ax2.barh(i, boost, xerr=ci, color=color, edgecolor='black', capsize=5, height=0.6)

ax2.axvline(x=0, color='red', linestyle='--', linewidth=2, label='No effect')
ax2.set_yticks(range(5))
ax2.set_yticklabels(['Shop 1', 'Shop 2', 'Shop 3', 'Shop 4', 'Shop 5'])
ax2.invert_yaxis()  # Shop 1 at top, Shop 5 at bottom
ax2.set_xlabel('Extra Cars Fixed (95% confidence range)', fontweight='bold', fontsize=8)
ax2.set_title('How Sure Are We?', fontweight='bold')

plt.tight_layout()
plt.show()
```

**Reading this chart:**

- **Green bars** = We're pretty confident your presence helps (the error bar doesn't cross zero)
- **Gray bars** = We're less certain (could go either way with more data)
- **Red dashed line** = Zero effect

**What you can trust:**

- âœ… **Shop 1 & Shop 4:** These boosts are real. The data is solid.
- âš ï¸ **Shop 2:** Shows a boost, but we only have 5 days of you being there. Need more data.
- âš ï¸ **Shops 3 & 5:** Benefits are smaller and less certain.

---

## The Money Question ðŸ’°

Let's say each car fixed earns you **$200 in profit**. Here's what different scheduling strategies could mean for your wallet:

```{python}
#| fig-cap: "Extra monthly profit above baseline under different scheduling strategies"
#| fig-width: 7
#| fig-height: 7

# Calculate average daily productivity for each scenario
avg_without_boss = carsDF[carsDF['boss'] == 0].groupby('shopID')['carsFixed'].mean()
avg_with_boss = carsDF[carsDF['boss'] == 1].groupby('shopID')['carsFixed'].mean()

# Assume 22 working days per month, Patrick can visit 1 shop per day
profit_per_car = 200

# Calculate baseline monthly profit (all 5 shops operating without boss visits)
baseline_monthly_profit = 22 * 5 * avg_without_boss.mean() * profit_per_car

# Scenario 1: Random visits (current pattern)
current_boost = summary_pivot['Boost'].mean()  # average boost across shops

# Scenario 2: Focus on Shop 1 & 4 (best shops)
best_boost = (summary_pivot.loc[1, 'Boost'] + summary_pivot.loc[4, 'Boost']) / 2

# Scenario 3: Only visit Shop 3 (brother's shop)
brother_boost = summary_pivot.loc[3, 'Boost']

# Scenario 4: Never visit (baseline)
no_visit_boost = 0

# Calculate EXTRA monthly profits from visits (above baseline)
scenarios = {
    'Never Visit\n(Baseline)': no_visit_boost * 22 * profit_per_car,
    'Random Visits\n(Current)': current_boost * 22 * profit_per_car,
    "Brother's Shop\n(Shop 3 Only)": brother_boost * 22 * profit_per_car,
    'Optimal Strategy\n(Shop 1 & 4)': best_boost * 22 * profit_per_car
}

fig, ax = plt.subplots(figsize=(7, 7))

colors_scenario = ['#E74C3C', '#F39C12', '#3498DB', '#27AE60']
bars = ax.bar(scenarios.keys(), scenarios.values(), 
              color=colors_scenario, edgecolor='black', linewidth=1.5)

ax.set_ylabel('Extra Monthly Profit ($)', fontsize=12, fontweight='bold')
ax.set_title('Extra Profit from Different Scheduling Strategies', 
             fontsize=14, fontweight='bold')

# Add dollar labels
for bar in bars:
    height = bar.get_height()
    label = f'${height:,.0f}'
    ax.annotate(label, xy=(bar.get_x() + bar.get_width()/2, height),
                xytext=(0, 5), textcoords='offset points',
                ha='center', fontsize=14, fontweight='bold')

# Format y-axis with dollar signs and K notation
ax.yaxis.set_major_formatter(plt.FuncFormatter(lambda x, p: f'${x/1000:.0f}K'))
ax.set_ylim(0, max(scenarios.values()) * 1.25)

plt.tight_layout()
plt.show()
```

### Long-Term Profit Projection ðŸ“ˆ

What do these strategies look like over a full year? Here's how your profits compound:

```{python}
#| fig-cap: "Cumulative extra profit projection over 12 months by scheduling strategy"
#| fig-width: 7
#| fig-height: 5

# Calculate monthly extra profits for each strategy
monthly_profits = {
    'Never Visit (Baseline)': no_visit_boost * 22 * profit_per_car,
    'Random Visits (Current)': current_boost * 22 * profit_per_car,
    "Brother's Shop Only (Shop 3)": brother_boost * 22 * profit_per_car,
    'Optimal Strategy (Shop 1 & 4)': best_boost * 22 * profit_per_car
}

# Create 12-month cumulative projection
months = np.arange(1, 13)
month_labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']

fig, ax = plt.subplots(figsize=(7, 5))

colors_line = {'Never Visit (Baseline)': '#E74C3C', 
               'Random Visits (Current)': '#F39C12',
               "Brother's Shop Only (Shop 3)": '#3498DB', 
               'Optimal Strategy (Shop 1 & 4)': '#27AE60'}

markers = {'Never Visit (Baseline)': 'o', 
           'Random Visits (Current)': 's',
           "Brother's Shop Only (Shop 3)": '^', 
           'Optimal Strategy (Shop 1 & 4)': 'D'}

for strategy, monthly in monthly_profits.items():
    cumulative = months * monthly
    ax.plot(months, cumulative, marker=markers[strategy], linewidth=2.5, 
            markersize=8, label=strategy, color=colors_line[strategy])
    # Add end-of-year label
    ax.annotate(f'${cumulative[-1]/1000:.0f}K', xy=(12, cumulative[-1]),
                xytext=(12.3, cumulative[-1]), fontsize=10, fontweight='bold',
                color=colors_line[strategy], va='center')

# Shade the area between optimal and random to show opportunity cost
optimal_cumulative = months * monthly_profits['Optimal Strategy (Shop 1 & 4)']
random_cumulative = months * monthly_profits['Random Visits (Current)']
ax.fill_between(months, random_cumulative, optimal_cumulative, alpha=0.2, color='#27AE60',
                label='Extra from Optimal vs Random')

ax.set_xlabel('Month', fontsize=12, fontweight='bold')
ax.set_ylabel('Cumulative Extra Profit ($)', fontsize=12, fontweight='bold')
ax.set_title('Long-Term Profit Projection: Optimal Strategy Compounds Over Time', 
             fontsize=14, fontweight='bold')
ax.set_xticks(months)
ax.set_xticklabels(month_labels)
ax.set_xlim(0.5, 13)

# Format y-axis with dollar signs and K notation
ax.yaxis.set_major_formatter(plt.FuncFormatter(lambda x, p: f'${x/1000:.0f}K'))

# Add legend
ax.legend(loc='upper left', fontsize=9, frameon=True)

# Add grid for readability
ax.grid(True, alpha=0.3, linestyle='--')

# Add annotation for yearly difference between optimal and random
yearly_diff = optimal_cumulative[-1] - random_cumulative[-1]
ax.annotate(f'Optimal advantage:\n+${yearly_diff/1000:.0f}K/year', 
            xy=(6, (optimal_cumulative[5] + random_cumulative[5])/2),
            fontsize=11, fontweight='bold', color='#27AE60',
            bbox=dict(boxstyle='round,pad=0.4', facecolor='white', edgecolor='#27AE60', alpha=0.9),
            ha='center')

plt.tight_layout()
plt.show()
```

**The compounding effect is clear:**

| Strategy | Monthly Extra | Annual Extra | vs. Optimal |
|----------|--------------|--------------|-------------|
| **Optimal (Shop 1 & 4)** | ~$43,100 | **~$517,000** | â€” |
| Random Visits | ~$36,900 | ~$443,000 | -$74K/year |
| Brother's Shop Only | ~$15,000 | ~$180,000 | -$337K/year |
| Never Visit | $0 | $0 | -$517K/year |

**The green shaded area** shows the extra profit you capture by switching from random visits to the optimal strategyâ€”that's an additional **~$74,000 per year** just by being smarter about where you spend your time.

**Translation:**

- ðŸŽ¯ **Optimal Strategy (Shop 1 & 4):** Could add ~$43,100/month in extra profit
- ðŸ“Š **Random Visits:** ~$36,900/month in extra profit
- ðŸ¤ **Brother's Shop Only:** ~$15,000/monthâ€”you'd be leaving money on the table
- âŒ **Never Visit:** $0 extraâ€”just baseline performance

---

## Your Action Plan ðŸ“‹

Based on 250 days of data, here's what we recommend:

### Priority Schedule

| Priority | Shop | Days/Week | Why |
|----------|------|-----------|-----|
| **ðŸ¥‡ High** | Shop 4 | 2-3 days | +12.6 cars/day boost. They need you most! |
| **ðŸ¥ˆ High** | Shop 1 | 2-3 days | +7.0 cars/day boost. Strong impact here too. |
| **ðŸ¥‰ Medium** | Shop 5 | 1 day | +8.8 cars/day boost, and already performs well. |
| **â¸ï¸ Low** | Shop 3 | Occasional | Your brother runs it fine. Visit socially! |
| **ðŸ“Š Watch** | Shop 2 | TBD | +10.1 boost but only 5 days of dataâ€”track more visits. |

### What Could Go Wrong?

Let's be honest about the limitations:

1. **Sample size:** 250 days isn't huge. Patterns could shift.
2. **Shop 2 data:** We only have 5 days of you being there. The +10.1 boost looks great, but it might not hold up.
3. **Other factors:** We don't know why your presence helps. Is it motivation? Oversight? Problem-solving? If something changes, the pattern could change.
4. **Seasonality:** We don't know if certain times of year are different.

### One Final Chart: Boss Presence Delta by Shop

```{python}
#| fig-cap: "All shops: Productivity split by boss presence"
#| fig-width: 6
#| fig-height: 16

# Set font for these charts
plt.rcParams['font.family'] = 'Georgia'

shop_colors = ['#E74C3C', '#3498DB', '#2ECC71', '#9B59B6', '#F39C12']
shop_names = ['Shop 1', 'Shop 2', 'Shop 3', 'Shop 4', 'Shop 5']

fig, axes = plt.subplots(5, 1, figsize=(6, 16))

for idx, shop in enumerate(range(1, 6)):
    ax = axes[idx]
    shop_color = shop_colors[idx]
    shop_name = shop_names[idx]
    
    shop_data = carsDF[carsDF['shopID'] == shop]
    
    # Split by boss presence
    boss_away = shop_data[shop_data['boss'] == 0]['carsFixed']
    boss_present = shop_data[shop_data['boss'] == 1]['carsFixed']
    
    # Calculate stats
    away_mean = boss_away.mean()
    present_mean = boss_present.mean()
    delta = present_mean - away_mean
    
    # Create boxplot with individual points
    positions = [0, 1]
    bp = ax.boxplot([boss_away, boss_present], positions=positions, widths=0.5,
                    patch_artist=True, showmeans=True,
                    meanprops={'marker': 'D', 'markerfacecolor': 'white', 
                               'markeredgecolor': 'black', 'markersize': 6})
    
    # Color the boxes
    bp['boxes'][0].set_facecolor('#E67E22')  # Away - orange
    bp['boxes'][1].set_facecolor('#27AE60')  # Present - green
    bp['boxes'][0].set_alpha(0.7)
    bp['boxes'][1].set_alpha(0.7)
    
    # Add jittered scatter points
    np.random.seed(42 + idx)
    jitter = 0.1
    ax.scatter(np.zeros(len(boss_away)) + np.random.uniform(-jitter, jitter, len(boss_away)),
               boss_away, alpha=0.4, s=20, c='#E67E22', edgecolors='white', linewidth=0.5)
    ax.scatter(np.ones(len(boss_present)) + np.random.uniform(-jitter, jitter, len(boss_present)),
               boss_present, alpha=0.4, s=20, c='#27AE60', edgecolors='white', linewidth=0.5)
    
    # Draw delta arrow between means
    ax.annotate('', xy=(1, present_mean), xytext=(0, away_mean),
                arrowprops=dict(arrowstyle='->', color='black', lw=1, ls='--'))
    
    # Add delta label
    delta_color = '#27AE60' if delta > 0 else '#E74C3C'
    delta_label = f'+{delta:.1f}' if delta > 0 else f'{delta:.1f}'
    ax.text(0.5, (away_mean + present_mean) / 2 + 3, f'Î” = {delta_label}',
            ha='center', fontsize=10, fontweight='bold', color=delta_color,
            bbox=dict(boxstyle='round', facecolor='white', edgecolor=delta_color, alpha=0.8))
    
    # Labels and title
    ax.set_xticks([0, 1])
    ax.set_xticklabels(['Boss Away', 'Boss Present'], fontsize=9)
    ax.set_ylabel('Cars Fixed', fontweight='bold', fontsize=9)
    ax.set_title(f'{shop_name}', fontsize=12, fontweight='bold', color=shop_color)
    ax.set_ylim(-10, 75)
    
    # Add sample size labels
    ax.text(0, -12, f'n={len(boss_away)}', ha='center', fontsize=8, style='italic')
    ax.text(1, -12, f'n={len(boss_present)}', ha='center', fontsize=8, style='italic')

# Add a shared legend to the figure
from matplotlib.patches import Patch
legend_elements = [Patch(facecolor='#E67E22', alpha=0.7, edgecolor='black', label='Boss Away'),
                   Patch(facecolor='#27AE60', alpha=0.7, edgecolor='black', label='Boss Present'),
                   Patch(facecolor='white', edgecolor='black', label='â—† = Mean')]
fig.legend(handles=legend_elements, loc='upper right', fontsize=10, bbox_to_anchor=(0.98, 0.99))

fig.suptitle('Boss Presence Impact Across All Shops', fontsize=14, fontweight='bold', y=1.0)
plt.tight_layout()
plt.subplots_adjust(top=0.92)
plt.show()
```

---

## Summary

**Patrick, here's what you need to remember:**

Question 1. **Your presence mattersâ€”but not equally everywhere.** Shop 1 and Shop 4 see the biggest boost when you're there.

**Answer:** The data clearly demonstrates this: Shop 4 shows a +12.6 cars/day boost and Shop 1 shows a +7.0 cars/day boost when you're present. In contrast, Shop 3 (your brother's shop) only shows a +3.4 cars/day improvement, while Shop 5 shows +8.8 and Shop 2 shows +10.1 (though with limited data). Your time investment yields vastly different returns depending on where you spend it.

Question 2. **Focus your time wisely.** Split your week between Shop 1 and Shop 4 for maximum impact. Don't feel guilty about visiting your brother lessâ€”Shop 3 does fine without you.

**Answer:** The recommended schedule is to spend 2-3 days per week at Shop 4 and 2-3 days per week at Shop 1. Shop 3, managed by your brother, performs adequately without your oversightâ€”the minimal +3.4 cars/day boost there means your time is better spent elsewhere. Visit Shop 3 socially, not for productivity reasons.

Question 3. **The potential gain is real.** Following this strategy could add ~$43,000+ per month compared to no visits.

**Answer:** At $200 profit per car, the optimal strategy (focusing on Shop 4 & 1) projects approximately $43,100/month in extra profit. Random visits yield roughly $36,900/month extra, while only visiting your brother's shop would generate just $15,000/month extra. The focused approach could generate roughly $6,200 more per month than random visits, translating to over $74,000 in additional annual profit.

Question 4. **Keep tracking.** This analysis is based on 250 days. The more data you collect, the more confident we can be.

**Answer:** The current analysis has limitations: only 250 total days of data, and Shop 2 has just 5 days where you were present (making that +10.1 boost estimate unreliable). Continued tracking will help validate whether these patterns hold, account for seasonal variations, and improve confidence in the recommendations. Consider systematically visiting Shop 2 more often to gather better data there.

**Questions?** The data speaks clearly: prioritize where your presence makes the biggest difference.

---

*Analysis based on 250 days of productivity data across 5 shops.*
